### ✍️ Tangxt ⏳ 2021-04-26 🏷️ 模板字符串

# 01-3-模板字符串、带标签的模板字符串、字符串的扩展方法

## ★模板字符串字面量

> Template literals (Template strings)

在 ES2015 中，还增强了定义字符串的方式

传统定义字符串的方式需要通过**单引号或者是双引号**来表示，而在 ES2015 中就新增了一种叫做「**模板字符串**」（早期 ES2015 的称呼，现在叫「模板字面量」）的方式 -> 它需要使用**反引号**去标识，即键盘当中`1`左边那个键

直接这样使用：

``` js
// 反引号包裹
const str = `hello es2015, this is a string`
```

跟普通字符串的使用没啥区别！

如果我们需要在内容当中使用反引号，那么我们同样也可以使用`\`去转义它：

``` js
const str = `hello es2015, this is a \`string\``
console.log(str) // hello es2015, this is a `string`
```

相比于普通字符串，这种模板字符串的方式，它多了一些非常有用的新特性

如：

传统的字符串不支持换行：

![传统字符串](assets/img/2021-04-27-11-03-02.png)

如果需要换行得用显示的`\n`换行符来搞：

![换行](assets/img/2021-04-27-11-04-17.png)

而在最新的模板字符串当中，它是可以支持多行字符串的，即我们可以在字符串当中直接敲个回车：

![不用输入换行符](assets/img/2021-04-27-11-08-37.png)

这一点**对于我们输出 HTML 字符串是非常方便的**

---

其次，模板字符串当中还支持通过**插值表达式**的方式在字符串中去嵌入所对应的数值 -> 语法是`${}`

如：

![插值表达式](assets/img/2021-04-27-11-14-40.png)

相比于之前字符串拼接的方式要方便多了，而且也更直观一点 -> 不容易写错！

总之，`${}`这个`{}`里边的内容就是标准 JavaScript，这意味着这`{}`里边，**不仅可以嵌入变量，还可以嵌入任何标准的 JS 语句**，而这语句的返回值最终会被输出到我们的字符串当中的那个插值表达式所存在的位置

💡：插入一个对象字面量？

![对象字面量](assets/img/2021-04-27-11-16-48.png)

相当于执行了这个`({}).toString()`

💡：`\`和`\n`的读法？

反斜线（`\`）是转义字符，用来表达字符串中的特殊字符，或将其后跟的字符解释为其本身 -> 也就是说`\`可以叫转义字符 -> 不过，似乎叫「用来转义的字符」比较好！

如`\n`，`\`让`n`这个普通字符转义成了特殊字符`newline`，而有意义的`'`，你`\'`就会让`'`转译成特殊字符`单引号` -> 其实它们就是相当于在字符串中输入一个回车字符、单引号字符罢了，只是这种输入形式很奇葩罢了！不像我们平时在纸上写字那样

转义字符（Escape character）的百度百科定义：

> 所有的 ASCII 码都可以用“`\`”加数字（一般是 8 进制数字）来表示。而 C 中定义了一些字母前加"`\`"来**表示常见的那些不能显示的 ASCII 字符**，如`\0`,`\t`,`\n` 等，就称为转义字符，因为后面的字符，都不是它本来的 ASCII 字符意思了。

➹：[转义字符 - MaxCompute - 阿里云](https://help.aliyun.com/document_detail/27869.html)

➹：[转义字符_百度百科](https://baike.baidu.com/item/%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6)

## ★模板字符串标签函数

> Tagged templates

模板字符串还有一个更高级的用法，就是在定义模板字符串之前去添加一个标签，而这个标签实际上就是一个特殊的函数 -> 添加了这个标签就是在调用这个函数

![tag](assets/img/2021-04-27-13-34-42.png)

例子：尝试用`console.log`作为模板字符串的标签

``` js
const str = console.log`hello world` // [ 'hello world' ]
```

其执行结果就是`log`了一个数组

话说，这里为啥会打印了一个数组出来了呢？

我们尝试自己定义一个使用标签函数的模板字符串 -> 使用标签函数前先定义一个函数（也可以后边定义，但为了更好的编码习惯，还是先定义再使用）

![标签函数](assets/img/2021-04-27-13-45-06.png)

`strings`这个数组里边的元素就是被`${}`分割过后的结果！ -> 在模板字符串当中可能会有嵌入的表达式，如果有，那就按照这些表达式分割过后那些**静态的内容**作为数组的一个个元素……

标签函数除了可以接收到这个数组以外，还可以接收到所有在这个模板字符串当中出现的**表达式的返回值** -> 如上图这个例子中`name`和`gender`这两个插值

接收`name`和`gender`的值：

``` js
const name = "tom";
const gender = true;
function myTagFunc(strings, name, gender) {
  console.log(strings); // [ 'hey, ', ' is a ', '.' ]
  console.log(typeof gender); // boolean
  console.log(name, gender); // tom true
}

const result = myTagFunc`hey, ${name} is a ${gender}.`;
console.log(result); // undefined
```

`myTagFunc`函数内部的返回值，就是我们的这个带标签的模板字符串所对应的返回值

为了返回正常的内容，我们返回模板字符串拼接过后的结果：

``` js
const name = "tom";
const gender = true;
function myTagFunc(strings, name, gender) {
  return strings[0] + name + strings[1] + gender + strings[2]
}

const result = myTagFunc`hey, ${name} is a ${gender}.`;
console.log(result); // hey, tom is a true.
```

这种标签函数的作用实际上就是**对我们的模板字符串进行加工**，如`gender`输出的结果是`true`或者`false`，那我们可以在这个`myTagFunc`函数里边对这个`gender`进行加工 -> 这样可以**让返回的结果更适合用户阅读**

![加工](assets/img/2021-04-27-14-11-14.png)

利用这个标签函数特性，我们可以去实现，如「文本的多语言化 -> 翻译成中文、英文等」、「检查模板字符串当中是否存在不安全的一些字符」之类的一些需求 -> 甚至，你还可以使用这种特性来去实现一个小型的模板引擎

## ★字符串的扩展方法





























